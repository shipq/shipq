// Code generated by portapi testharness generator. DO NOT EDIT.
// This file is test-only and will not be included in production builds.

package gen

import (
	"net/http"
	"net/http/httptest"
	"testing"
)

// NewTestClient creates a test client configured for the given httptest.Server.
//
// It uses ts.Client() to get an HTTP client properly configured for the test server
// (handling cookies, redirects, and TLS settings), and ts.URL as the base URL.
//
// This function panics if ts is nil, as that indicates a bug in the test setup.
//
// Example usage:
//
//	ts := httptest.NewServer(NewMux())
//	defer ts.Close()
//	client := NewTestClient(ts)
//	resp, err := client.SomeEndpoint(ctx, req)
func NewTestClient(ts *httptest.Server) *Client {
	if ts == nil {
		panic("NewTestClient: nil httptest.Server")
	}
	return &Client{
		BaseURL: ts.URL,
		HTTP:    ts.Client(),
	}
}

// NewTestServer creates an httptest.Server from the provided handler.
//
// The server is automatically closed when the test completes via t.Cleanup.
//
// Example usage:
//
//	mux := http.NewServeMux()
//	// ... register your handlers ...
//	ts := NewTestServer(t, mux)
//	client := NewTestClient(ts)
//	resp, err := client.SomeEndpoint(ctx, req)
func NewTestServer(t *testing.T, handler http.Handler) *httptest.Server {
	t.Helper()
	ts := httptest.NewServer(handler)
	t.Cleanup(ts.Close)
	return ts
}
